# バイクワッドフィルタ
## 伝達関数
バイクワッドフィルタの伝達関数$H(z)$は，
\[
    H(z) = \frac{b_0 + b_1z^{-1} + b_2z^{-2}}{a_0 + a_1z^{-1} + a_2z^{-2}}
\]
である．差分方程式に変換すると，入力を$x[n]$，出力を$y[n]$として，
\[
    y[n] = \Bigl(\frac{b_0}{a_0}\Bigr)x[n] + \Bigl(\frac{b_1}{a_0}\Bigr)x[n-1] + \Bigl(\frac{b_2}{a_0}\Bigr)x[n-2] - \Bigl(\frac{a_1}{a_0}\Bigr)y[n-1] - \Bigl(\frac{a_2}{a_0}\Bigr)y[n-2]
\]
で表される．実装では此方を使う．

## 事前準備
プリワーピングにより，事前にプロトタイプフィルタの周波数を計算しておく必要があり，その周波数$\omega_0$は，ディジタルフィルタの遮断周波数を$f_0$とすると，
\[
    \omega_0 = 2\pi\frac{f_0}{F_s}
\]
となる．ここで，$F_s$はサンプリング周波数である．\
また，$Q$を$Q$値として，
\[
    \alpha = \frac{\sin \omega_0}{2Q}
\]
を事前に計算しておく．$Q$値は遮断周波数において，ゲインの減衰量が$1/\sqrt{2}$となる点とする．

## ローパスフィルタ
ローパスフィルタの伝達関数は，
\[
    H(s) = \frac{1}{s^2 + \frac{s}{Q} + 1}
\]
であり，各係数は以下のように計算される．
\[
    b_0 = \frac{1 - \cos \omega_0}{2}\\
    b_1 = 1 - \cos \omega_0\\
    b_2 = \frac{1 - \cos \omega_0}{2}\\
    a_0 = 1 + \alpha\\
    a_1 = -2\cos \omega_0\\
    a_2 = 1 - \alpha\\
\]
 